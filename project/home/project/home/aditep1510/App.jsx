import React, { useState } from "react";

const quizData = [
  {
    story:
      "คุณคือเป็ดตัวหนึ่งในฝูง วันนี้ฝูงเป็ดต้องเดินทางผ่านป่าที่ว่ากันว่ามีสัตว์ปีศาจอยู่มากมาย เพื่อช่วยเพื่อนเป็ดที่ติดอยู่ฝั่งตรงข้าม แต่ระหว่างทางมีเรื่องให้เลือกตัดสินใจหลายอย่าง พร้อมลุยไปกับการผจญภัยนี้มั้ย?",
    question: "1. ทางเข้าป่าข้างหน้าเป็นดงไม้แสนมืดมิด คุณจะทำยังไง?",
    answers: [
      { text: "หยุดคิดแผน", scores: { วางหมาก: 2, นักคิด: 1 } },
      { text: "ชวนฝ่าไปเลย", scores: { สายลุย: 2, แม่ทัพ: 1 } },
      { text: "อาจมีสัตว์น่ารัก", scores: { แรงบันดาลใจ: 2, ศิลปิน: 1 } },
      { text: "คอยเชียร์เพื่อน", scores: { ใจดี: 2, แรงบันดาลใจ: 1 } },
    ],
  },
  {
    story: "เข้าป่ามาได้แล้วววววว",
    question: "2. เพื่อนเป็ดตัวหนึ่งกำลังกลัวความมืดมิดในป่านี้ คุณจะทำยังไง?",
    answers: [
      {
        text: "อยู่ข้าง ๆ และคอยปลอบใจอยู่ตลอดเวลา",
        scores: { ใจดี: 2, แรงบันดาลใจ: 1 },
      },
      {
        text: "ชวนคุยเล่นสนุก ๆ แก้เครียดกันดีกว่า",
        scores: { สายลุย: 2, ศิลปิน: 1 },
      },
      {
        text: "ให้กำลังใจและพูดให้มองในแง่ดี",
        scores: { แรงบันดาลใจ: 2, ใจดี: 1 },
      },
      {
        text: "ช่วยวางแผนแก้ปัญหาให้เพื่อนสบายใจ",
        scores: { วางหมาก: 2, นักคิด: 1 },
      },
    ],
  },
  {
    story:
      "เดินทางจนดึกแล้ว เจอกระท่อมหลังหนึ่งในป่าพอดี พักค้างคืนที่กระท่อมนี้แหละ",
    question: "3. คลายเครียดด้วยการจัดงานเลี้ยงกัน! คุณจะจัดงานเลี้ยงแบบไหน?",
    answers: [
      { text: "วางแผนหน้าที่ มีแผนสำรอง", scores: { วางหมาก: 2, แม่ทัพ: 1 } },
      { text: "คอยดูแลความรู้สึกทุกตัว", scores: { ใจดี: 2, แรงบันดาลใจ: 1 } },
      {
        text: "ประดิษฐ์ของตกแต่งงานให้สวยงาม!",
        scores: { ศิลปิน: 2, แรงบันดาลใจ: 1 },
      },
      { text: "คุมเวลาให้งานเสร็จเป๊ะ", scores: { แม่ทัพ: 2, วางหมาก: 1 } },
    ],
  },
  {
    story:
      "ใกล้ถึงแม่น้ำใหญ่ที่ต้องข้ามแล้ว แต่ดูเหมือนมีบางสิ่งลอยอยู่ในน้ำ...",
    question: "4. ข้ามแม่น้ำยังไงดี?",
    answers: [
      { text: "ใช้ใบไม้สร้างแพข้าม", scores: { วางหมาก: 2, ศิลปิน: 1 } },
      { text: "ว่ายนำนำฝูงข้ามไปเลย", scores: { สายลุย: 2, แม่ทัพ: 1 } },
      { text: "ให้กำลังใจทุกตัวว่าทำได้", scores: { แรงบันดาลใจ: 2, ใจดี: 1 } },
      { text: "อาสาข้ามไปดูก่อนคนแรก", scores: { ใจดี: 2, สายลุย: 1 } },
    ],
  },
  {
    story: "ปีศาจเป็ดตัวร้ายบุกมาแล้ว!",
    question: "5. คุณจะพูดว่า...?",
    answers: [
      { text: "ขอเวลาคิดแผนก่อนนะ!", scores: { นักคิด: 2, วางหมาก: 1 } },
      { text: "รุมต่อยมันเลย!", scores: { สายลุย: 2, แม่ทัพ: 1 } },
      {
        text: "ไม่ต้องกลัวนะ ฉันอยู่นี่แล้ว",
        scores: { แรงบันดาลใจ: 2, ใจดี: 1 },
      },
      { text: "อะไรทำให้เขาบุกมาที่นี่?", scores: { ลึกลับ: 2, นักคิด: 1 } },
    ],
  },
  {
    story: "พวกเป็ดต้องหาเส้นทางใหม่",
    question: "6. เจอไอเดียใหม่ ๆ แล้ว คุณจะ...?",
    answers: [
      { text: "ลงมือทำทันที!", scores: { ศิลปิน: 2, สายลุย: 1 } },
      { text: "แชร์ไอเดียให้เพื่อนฟัง", scores: { แรงบันดาลใจ: 2, ใจดี: 1 } },
      { text: "เขียนแผนงานไว้ก่อน", scores: { วางหมาก: 2, นักคิด: 1 } },
      {
        text: "คิดลึก ๆ ว่าทางข้างหน้าจะเป็นยังไง?",
        scores: { ลึกลับ: 2, นักคิด: 1 },
      },
    ],
  },
  {
    story: "ได้เส้นทางใหม่แล้ว! แต่มีแม่น้ำเชี่ยวอยู่",
    question: "7. คุณจะช่วยทีมยังไง?",
    answers: [
      { text: "วางแผนสร้างสะพานชั่วคราว", scores: { วางหมาก: 2, นักคิด: 1 } },
      {
        text: "ให้กำลังใจเพื่อนที่กลัวน้ำ",
        scores: { ใจดี: 2, แรงบันดาลใจ: 1 },
      },
      { text: "วาดภาพสะพานและบรรยากาศรอบ ๆ", scores: { ศิลปิน: 2, ลึกลับ: 1 } },
      {
        text: "เป็นหัวหน้าจัดทีมข้ามแม่น้ำ",
        scores: { แม่ทัพ: 2, วางหมาก: 1 },
      },
    ],
  },
  {
    story: "ข้ามน้ำมาเจอศิลาจารึกโบราณในป่า",
    question: "8. คุณจะ...?",
    answers: [
      { text: "วิเคราะห์ข้อความทีละบรรทัด", scores: { ลึกลับ: 2, นักคิด: 1 } },
      {
        text: "เป็นรหัสลับอะไรรึเปล่า?",
        scores: { แรงบันดาลใจ: 2, ลึกลับ: 1 },
      },
      { text: "มีผีสิงแน่นอน เก็บกลับมาขาย", scores: { สายลุย: 2, ศิลปิน: 1 } },
      { text: "มีคำสาป จับแล้วตายแน่นอน", scores: { ใจดี: 2, ลึกลับ: 1 } },
    ],
  },
  {
    story: "คำจารึกบอกทางและเตือนเรื่องกับดัก",
    question: "9. ตั้งแคมป์คืนนี้ คุณอยากทำอะไร?",
    answers: [
      { text: "วาดภาพบรรยากาศรอบ ๆ", scores: { ศิลปิน: 2, แรงบันดาลใจ: 1 } },
      { text: "หยิบหนังสือขึ้นมาอ่าน", scores: { ลึกลับ: 2, นักคิด: 1 } },
      { text: "หาเกมเล่นสนุก ๆ", scores: { สายลุย: 2, ศิลปิน: 1 } },
      {
        text: "เตรียมของและวางแผนวันพรุ่งนี้",
        scores: { วางหมาก: 2, แม่ทัพ: 1 },
      },
    ],
  },
  {
    story: "เพื่อนเป็ดบาดเจ็บเล็กน้อย",
    question: "10. คุณช่วยยังไง?",
    answers: [
      { text: "เข้าไปถามก่อนใคร", scores: { ใจดี: 2, แรงบันดาลใจ: 1 } },
      { text: "คิดวิธีช่วยเร็วที่สุด", scores: { แม่ทัพ: 2, วางหมาก: 1 } },
      { text: "ช่วยทำแผลให้น่ารัก", scores: { ศิลปิน: 2, ใจดี: 1 } },
      { text: "เตรียมของรับมือบาดเจ็บ", scores: { วางหมาก: 2, นักคิด: 1 } },
    ],
  },
  {
    story: "มาถึงทางเดินที่เต็มไปด้วยกับดัก",
    question: "11. คุณจะช่วยทีมยังไง?",
    answers: [
      { text: "วางแผนหลีกเลี่ยงกับดัก", scores: { วางหมาก: 2, นักคิด: 1 } },
      { text: "ส่งเสียงเตือนเพื่อน", scores: { ใจดี: 2, แรงบันดาลใจ: 1 } },
      { text: "กล้าลุยบุกผ่านไปก่อน", scores: { สายลุย: 2, แม่ทัพ: 1 } },
      { text: "คิดหาทางออกที่ฉลาดสุด", scores: { ลึกลับ: 2, นักคิด: 1 } },
    ],
  },
  {
    story: "มีเสียงแปลก ๆ จากป่า",
    question: "12. คุณจะ...?",
    answers: [
      { text: "คิดหาว่าเสียงนั้นคืออะไร", scores: { นักคิด: 2, ลึกลับ: 1 } },
      { text: "รีบไปดูทันที", scores: { สายลุย: 2, แม่ทัพ: 1 } },
      { text: "สังเกตเพื่อนที่กลัวเสียง", scores: { ใจดี: 2, แรงบันดาลใจ: 1 } },
      { text: "สั่งทีมเตรียมตัวระวังภัย", scores: { แม่ทัพ: 2, วางหมาก: 1 } },
    ],
  },
  {
    story: "เจอเป็ดที่หายไปแล้ว เย้!",
    question: "13. ตอนผจญภัยจบ คุณได้เรียนรู้อะไร?",
    answers: [
      { text: "การวางแผนช่วยผ่านอุปสรรค", scores: { วางหมาก: 2, นักคิด: 1 } },
      {
        text: "เข้าใจกันสร้างทีมแข็งแกร่ง",
        scores: { ใจดี: 2, แรงบันดาลใจ: 1 },
      },
      {
        text: "ไม่ยอมแพ้และเชื่อมั่นในตนเอง",
        scores: { สายลุย: 2, แรงบันดาลใจ: 1 },
      },
      { text: "ผู้นำและทีมที่ดีสำคัญมาก", scores: { แม่ทัพ: 2, วางหมาก: 1 } },
    ],
  },
  {
    question: "14. ถ้าคุณจะถูกจดจำในฝูงนี้ อยากให้เพื่อน ๆ รู้จักคุณแบบไหน?",
    answers: [
      {
        text: "คนที่เข้าใจโลกและมองการณ์ไกล",
        scores: { ลึกลับ: 2, นักคิด: 1 },
      },
      {
        text: "คนที่พร้อมจะซัพพอร์ตและเข้าใจทุกคน",
        scores: { แรงบันดาลใจ: 2, ใจดี: 1 },
      },
      {
        text: "คนที่ไม่เคยยอมแพ้และเชื่อมั่นในตนเอง",
        scores: { สายลุย: 2, แม่ทัพ: 1 },
      },
      { text: "คนที่ทุกคนไว้ใจ", scores: { วางหมาก: 2, แม่ทัพ: 1 } },
    ],
  },
];

export default function App() {
  const [currentQuestion, setCurrentQuestion] = useState(0);
  const [showStory, setShowStory] = useState(true);
  const [showResult, setShowResult] = useState(false);
  const [answersCount, setAnswersCount] = useState({
    วางหมาก: 0,
    สายลุย: 0,
    แรงบันดาลใจ: 0,
    ใจดี: 0,
    ลึกลับ: 0,
    แม่ทัพ: 0,
    นักคิด: 0,
    ศิลปิน: 0,
  });

  const handleAnswer = (scores) => {
    // scores เป็น object เช่น { วางหมาก: 2, นักคิด: 1 }
    setAnswersCount((prev) => {
      const updated = { ...prev };
      for (const key in scores) {
        if (scores.hasOwnProperty(key)) {
          updated[key] = (updated[key] || 0) + scores[key];
        }
      }
      return updated;
    });

    const nextQuestion = currentQuestion + 1;
    if (nextQuestion < quizData.length) {
      setCurrentQuestion(nextQuestion);
      setShowStory(true);
    } else {
      setShowResult(true);
    }
  };

  const getResult = () => {
    const max = Math.max(...Object.values(answersCount));
    const result = Object.keys(answersCount).filter(
      (key) => answersCount[key] === max
    );
    // อาจมีหลายอันดับ 1 คืนเป็น array ได้
    return result.join(", ");
  };

  return (
    <div style={{ padding: "20px", fontFamily: "sans-serif" }}>
      {showResult ? (
        <div>
          <h2>คุณคือเป็ดสาย: {getResult()}</h2>
        </div>
      ) : showStory ? (
        <div>
          <p>{quizData[currentQuestion].story}</p>
          <button onClick={() => setShowStory(false)}>เริ่มตอบคำถาม</button>
        </div>
      ) : (
        <div>
          <h3>{quizData[currentQuestion].question}</h3>
          {quizData[currentQuestion].answers.map((answer, index) => (
            <button
              key={index}
              onClick={() => handleAnswer(answer.scores)}
              style={{ display: "block", margin: "10px 0" }}
            >
              {answer.text}
            </button>
          ))}
        </div>
      )}
    </div>
  );
}
